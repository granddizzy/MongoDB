Задание 4

Цель практической работы:
Научиться писать аналитические запросы в MongoDB.

Что нужно сделать:
Посчитайте сумму кармы по первым буквам имён пользователей для тех пользователей, у которых больше 300 визитов.
Советы и указания
Для выбора первой буквы имени используйте ключевое слово substr.

db.users.aggregate([
  { $match: { visits: { $gt: 300 } } },
  { $addFields: { first_letter: { $substr: ["$first_name", 0, 1] } } },
  { $group: { _id: "$first_letter", total_karma: { $sum: "$karma" } } }
])

в метод aggregate передаем массив документов для выполнения в pipeline.
$match выполняет фильтрацию пользователей с более чем 300 визитами

$addFields добавляет новое поле для агрегации first_letter.
Создает его используя $substr который используется для извлечения подстроки из строки
по заданному начальному индексу и длине. В данном случае 1ую букву.

$group группирует пользователей используя "$first_letter" (подставляет значение) и создает total_karma
используя $sum для суммирования "$karma" (подставляет значение)